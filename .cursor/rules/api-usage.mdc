---
description: "API 接口开发规范 - 请求工具/类型定义/错误处理"
globs: "src/apis/**,src/types/api/**,src/utils/request/**"
---

# API 接口开发规范

## 文件组织

本项目采用前后端分离架构，API接口开发遵循统一的规范和最佳实践。

## 文件组织结构

### 接口定义层次
```
后端接口定义: E:\workspace\bean-milk\superone\backend-superone\app\api_service\api_service.go
后端参数定义: E:\workspace\bean-milk\superone\backend-superone\internal\domain\*\*_dto\*
后端表定义: E:\workspace\bean-milk\superone\backend-superone\internal\model\*
前端参数定义: src/types/api/*.ts
前端接口定义: src/apis/*.ts
接口请求工具: src/utils/request.ts
```

### 前端API文件结构
```
src/
├── apis/           # 接口实现（user.ts/flow.ts等）
├── types/api/      # 接口类型（base.ts/user.ts等）
└── utils/request/  # 请求工具
```

## 请求工具

### 基本用法
```typescript
import { request } from '@/utils/request'

// GET
const users = await request.get<UserInfo[]>('/api/users')

// POST
const result = await request.post<UserInfo>('/api/users', userData)

// 带参数
const list = await request.get<PaginatedResponse<UserInfo>>('/api/users', {
  params: { offset: 0, limit: 10 }
})
```

### 错误处理
```typescript
try {
  const result = await userApi.getUserList({ page: 1, pageSize: 10 })
  // 处理结果
} catch (error) {
  logger.error('获取用户列表失败', error)
  if (window.utools && typeof window.utools.showNotification === 'function') {
    window.utools.showNotification('加载失败')
  }
}
```

## 最佳实践

1. **类型安全**：所有接口明确请求/响应类型
2. **错误处理**：统一拦截 + 局部 try-catch + 日志
3. **参数验证**：请求前校验必填字段
4. **统一范式**：响应结构与数据模型对齐